---
title: C Part 4 | Advanced Topics
layout: post
---

## Bitwise Operations

这一节我们研究如何使用位运算，完成加减乘的数学运算。在介绍每种运算之前，先来复习下基本的逻辑运算：

|---|---|---|---|---|---|
|x| y | AND | OR | XNOR(同或) | XOR(异或)
|0| 0 | 0 | 0 | 1 | 0 |
|0| 1 | 0 | 1 | 0 | 1 |
|1| 0 | 0 | 1 | 0 | 1 |
|1| 1 | 1 | 1 | 1 | 0 |

### 四则运算

- 加法

我们先使用真值表分析两个bit相加的几种情况，进而推算出多个bit的加法规则

|---|---|---|---|
|x| y | sum | carry |
|0| 0 | 0 | 0 |
|0| 1 | 1 | 0 |
|1| 0 | 1 | 0 |
|1| 1 | 0 | 1 |

由上面的真值表可以推到看出:

1. `sum = x XOR y`
2. `carry = x AND y`

回想十进制的两位数加法规则，如果个位相加有进位，则十位要累加进位，同样的规则也适用于位运算，我们将上面真值表中加入上一次计算的进位项：

|---|---|:---:|---|---|
|x| y | last carry |sum | carry |
|0| 0 | 0 | 0 | 0 |
|0| 0 | 1 | 1 | 0 |
|0| 1 | 0 | 1 | 0 |
|0| 1 | 1 | 0 | 1 |
|1| 0 | 0 | 1 | 0 |
|1| 0 | 1 | 0 | 1 |
|1| 1 | 0 | 0 | 1 |
|1| 1 | 1 | 0 | 1 |

由上面真值表不难发现，多个bit的叠加是一个循环的过程，即第0为产生的carry带给第1位，第1位产生的carry带给第2位，以此类推

```cpp
int add(int a, int b){

    int carry = 0;
    int sum = 0;
    do{
        sum = a^b;
        carry = (a&b)<<1;
        sum = a;
        carry = b;
    }while(carry > 0)
    
    return sum;
}

```


